# 系统设计

学习如何设计可扩展的大型系统。

## 可扩展性

- 垂直扩展
- 水平扩展
- 缓存
- 负载均衡
- 数据库复制
- 数据库分区

**高阶的权衡和取舍**

- 性能与可扩展性
- 延迟与吞吐量
- 可用性与一致性

## 性能与可扩展性

- 如果你的系统有**性能**问题，对于单个用户来说是缓慢的。
- 如果你的系统有**可扩展性**问题，单个用户较快但在高负载下会变慢。

## 延迟与吞吐量

- **延迟**是执行操作或运算结果所花费的时间。

- **吞吐量**是单位时间内（执行）此类操作或运算的数量。

通常，你应该以**可接受级延迟**下**最大化吞吐量**为目标。

## 可用性与一致性

- CAP理论（consistency,availability,Partition Tolerance）

  - 在一个分布式计算系统中，只能同时满足下列的两点:

    - **一致性** ─ 每次访问都能获得最新数据但可能会收到错误响应
    - **可用性** ─ 每次访问都能收到非错响应，但不保证获取到最新数据
    - **分区容错性** ─ 在任意分区网络故障的情况下系统仍能继续运行

    **网络并不可靠，所以你应要支持分区容错性，并需要在软件可用性和一致性间做出取舍。**

  - CP ─ 一致性和分区容错性

  - AP ─ 可用性与分区容错性

- 一致性模式

  - 弱一致性
  - 最终一致性
  - 强一致性

- 可用性模式

  - 故障切换（fail-over）
    - 工作到备用切换（Active-passive）
    - 双工作切换（Active-active）
    - 缺陷
      - 故障切换需要添加额外硬件并增加复杂性
      - 如果新写入数据在能被复制到备用系统之前，工作系统出现了故障，则有可能会丢失数据
  - 复制（replication）
    - 主从复制
    - 主主复制

## 域名系统



## 内容分发网络（CDN）

内容分发网络（CDN）是一个全球性的代理服务器分布式网络，它从靠近用户的位置提供内容。通常，HTML/CSS/JS，图片和视频等静态内容由 CDN 提供。

## 负载均衡器

## 反向代理

## 应用层

## 微服务

可以被描述为一系列可以独立部署的小型的，模块化服务。每个服务运行在一个独立的线程中，通过明确定义的轻量级机制通讯，共同实现业务目标。



